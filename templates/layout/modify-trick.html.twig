{% extends'base.html.twig' %}

{% block header %}
    {{ parent() }}
    <div class="banner fullheight modify-trick">
        {% if trick.mainImage is defined and trick.mainImage is not null %}
            <img src="{{ asset('images/tricks/' ~ trick.mainImage) }}" alt="home banner">
        {% else %}
            {% if trick.trickImages is defined %}
                <img src="{{ asset('images/tricks/' ~ trick.trickImages|first.path) }}" alt="home banner">
            {% else %}
                <img src="{{ asset('images/homebanner.jpg') }}" alt="home banner">
            {% endif %}
        {% endif %}
        <h1>{{ trick.name }}</h1>

        <div class="trick-action py-2 px-1 d-flex justify-content-around">
            <a data-toggle="modal" data-target="#main-image-modal" href="#"><i class="icon-pencil"></i></a>
            <a href="{{ path('deleteMainImageTrick', {id: trick.id}) }}"><i class="icon-bin"></i></a>
        </div>

    </div>
{% endblock %}

{% block body %}

    <main class="single-trick modify-trick">

        <div class="row justify-content-center">

            <button id="display-medias" class="btn btn-lg btn-primary my-3">Voir m√©dias</button>

        </div>

        <div id="media-row" class="row image-videos justify-content-around">
            {% if trick.trickImages is defined %}
                {% for image in trick.trickImages %}
                    <div class="single-image col-lg-2 my-4">
                        <img src="{{ asset('images/tricks/' ~ image.path) }}" alt="Trick image">
                        <div class="trick-action py-2 px-1 d-flex justify-content-around mt-4">
                            <a data-toggle="modal" data-target="#single-image-modal" href="#"><i
                                        class="icon-pencil"></i></a>
                            <a href="{{ path('deleteSingleImageTrick', {id: trick.id, trickImage_id: image.id}) }}"><i
                                        class="icon-bin"></i></a>
                        </div>
                    </div>
                {% endfor %}
            {% endif %}
            {% if trick.trickVideos is defined %}
                {% for video in trick.trickVideos %}
                    <div class="single-video col-lg-2 my-4">
                        {{ video.embed|raw }}
                        <div class="trick-action py-2 px-1 d-flex justify-content-around mt-4">
                            <a data-toggle="modal" data-target="#main-image-modal" href="#"><i class="icon-pencil"></i></a>
                            <a href="{{ path('deleteMainImageTrick', {id: trick.id}) }}"><i class="icon-bin"></i></a>
                        </div>
                    </div>
                {% endfor %}
            {% endif %}
        </div>

        <section class="row">
            {{ form_start(trickForm, {'attr' : {'class':'d-flex align-items-center flex-sm-column flex-row offset-lg-3 col-lg-6', 'id' : 'trick-form'}}) }}
            {{ form_row(trickForm.name,{'attr' : {'class' : 'col-lg-10'}}) }}
            {{ form_row(trickForm.description,{'attr' : {'class' : 'col-lg-12'}}) }}
            {{ form_row(trickForm.group,{'attr' : {'class' : 'col-lg-4'}}) }}
            <div class="submit d-flex justify-content-end">
                <a class="btn btn-lg btn-danger ml-2" href="{{ path('deleteTrick', {id: trick.id}) }}">Supprimer</a>
                <button type="submit" class="btn btn-lg btn-primary ml-2">Sauvegarder</button>
            </div>
            {{ form_end(trickForm) }}
        </section>


        <!-- Main Image modal -->
        <div class="modal fade" id="main-image-modal" tabindex="-1" role="dialog" aria-labelledby="main-image-modal"
             aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body d-flex">
                        {{ form_start(trickMainImageForm, {'attr' : {'class':'d-flex align-items-center flex-column flex-sm-row'}}) }}
                        {{ form_row(trickMainImageForm.mainImage, {'attr': {'class': 'form-control-file.'}}) }}
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                        <button type="submit" class="btn btn-primary">Sauvegarder</button>
                        {{ form_end(trickMainImageForm) }}
                    </div>
                </div>
            </div>
        </div>

        <!-- Single Image modal -->
        <div class="modal fade" id="single-image-modal" tabindex="-1" role="dialog" aria-labelledby="main-image-modal"
             aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body d-flex">
                        {{ form_start(trickSingleImageForm, {'attr' : {'class':'d-flex align-items-center flex-column flex-sm-row'}}) }}
                        {{ form_row(trickSingleImageForm.path, {'attr': {'class': 'form-control-file.'}}) }}
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                        <button type="submit" class="btn btn-primary">Sauvegarder</button>
                        {{ form_end(trickSingleImageForm) }}
                    </div>
                </div>
            </div>
        </div>


    </main>

    <script type="application/javascript">
        $('input[type="file"]').change(function (e) {
            var fileName = e.target.files[0].name;
            $('.custom-file-label').html(fileName);
        });
    </script>

{% endblock %}


